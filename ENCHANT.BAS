10 CLS:C=RND(-TIMER)20 '437 PMODE3,1:PCLS:SCREEN1,1440 DIMP(4,26),M$(3,29),D(3,29),T$(12)450 C=0:E=0:F=0:G=1:L=0:A=2:ERR=0:N5=0:Y=1470 V$="LOO":N$="EAS":GOTO1200560 IFN5=0GOSUB4850562 IFN5=1THENN5=2:GOSUB1950:GOSUB3990:Y=1:V$="LOO":N$="SOU":GOTO1200565 RY$=INKEY$570 IFRY$=""THEN560580 ASK=0:CLS590 PRINT:PRINT"YOUR COMMAND IS "600 INPUTR$:PRINT" "610 IFR$="N"THENR$="GO NOR620 IFR$="S"THENR$="GO SOU630 IFR$="E"THENR$="GO EAS640 IFR$="W"THENR$="GO WES650 IFR$="LOOK"THENPRINT"WHICH DIRECTION ":GOTO600660 IFLEN(R$)<3THENPRINT"WHAT DID YOU SAY ":GOTO590670 V$=LEFT$(R$,3):FORX=(LEN(R$)-2)TO1STEP-1680 IFMID$(R$,X,1)=" "THEN690ELSENEXT690 N$=MID$(R$,X+1,3)700 IFV$="GO "THEND(1,3)=RND(16):GOTO830710 IFV$="GET"ORV$="TAK"THEN1010720 IFV$="LOO"THEN1200730 IFV$="DRO"THEN1260740 IFV$="KIL"THEN1300750 IFV$="JUM"THEN1360760 IFV$="ASK"THENASK=1:GOTO1410770 IFV$="OPE"THEN1480780 IFV$="VAN"THEN1550790 IFV$="PAY"THEN1565800 IFV$="RUB"THEN1590810 IFV$="EAT"THEN1610811 IFV$="WHA"ORV$="WHO"THEN812ELSE816812 K=1:FORJ=1TO29:IFD(1,J)=Y ANDD(3,J)=1THENK=2:PRINT" THAT'S ";M$(2,J)813 NEXT:IFD(1,14)=0ANDY=13ANDM$(1,17)="Z"THENPRINT" THAT'S ";M$(2,23)814 IFK=1THENPRINT" THERE'S NOTHING AROUND":K=0:GOTO590815 IFK=2THENK=0:GOTO590816 IFV$="WHE"THENPRINT" LOOK IN ALL DIRECTIONS":GOTO590820 PRINT" THAT VERB IS NOT IN MY":PRINT" VOCABULARY ":GOTO590830 IFY=23ORY=24ORY=25ORY=26THEN1750835 IFROCK=0ANDY=21ANDN$="SOU"THENPRINT" YOU CAN'T, THERE'S A ROCK.":GOTO590840 IF(N$="EAS"ORN$="WES")ANDY=5THEN1660845 IFN$="PAT"THENPRINT"WHICH DIRECTION ":GOTO600850 IFN$="NOR"ANDP(1,Y)<>0THENY=P(1,Y):GOTO1200860 IFN$="SOU"ANDP(2,Y)<>0THENY=P(2,Y):GOTO1200870 IFN$="EAS"ANDP(3,Y)<>0THENY=P(3,Y):GOTO1200880 IFN$="WES"ANDP(4,Y)<>0THENY=P(4,Y):GOTO1200885 IFN$="NOR"ORN$="SOU"ORN$="EAS"ORN$="WES"THENPRINT" THERE IS NO PATH.":GOTO590900 IFN$="LAK"ANDY=8THENPRINT" NOT YET.":GOTO590930 IFN$="CAV"ANDY=16ANDT=0THEN2900940 IFN$="CAV"ANDY=16ANDT=1ANDD(1,18)=99THENY=17:GOTO3200950 IFN$="CAV"ANDY=16ANDT=1ANDD(1,18)<>99THEN2950960 IFN$="FOR"ANDY=1THENY=3:PATH=1:GOTO3200970 IFN$="FOR"ANDY<>1THENPRINT"YOU ARE ALREADY IN THE FOREST.":GOTO590980 IFN$="CAS"ANDY=1ANDD(1,2)=99THEN1900990 IFN$="CAS"ANDY=1ANDD(1,2)<>99THENPRINT" NOT YET.":GOTO5901000 PRINT"I DON'T UNDERSTAND YOUR REQUEST ":GOTO5901010 IFN$<>"INV"THEN10801020 F=01030 FORX=1TO291040 IFD(1,X)=99THENPRINTTAB(2)M$(2,X):F=11050 NEXT1060 IFF=0THENPRINT" YOU HAVE NOTHING1070 GOTO5901080 IFN$="CHE"ANDD(1,15)=13ANDY=13THENM$(1,15)="Z":M$(1,17)="TRU":D(1,15)=0:D(1,17)=13:X=23:GOTO11901085 FORX=1TO291090 IFN$=M$(1,X)THEN1110ELSENEXT1100 PRINT" THAT NOUN IS NOT IN MY":PRINT" VOCABULARY.":GOTO5901110 IFD(1,X)=99THENPRINT"YOU ALREADY HAVE IT":GOTO5901120 IFD(1,X)<>Y THENPRINT"I DON'T SEE THAT":GOTO5901130 IFN$="PRI"ANDD(2,X)=0THENPRINT" YOU CAN'T YET":GOTO5901140 IFN$="PRI"ANDD(1,29)=99THENPRINT" YOU HAVE HER":D(1,2)=99:GOTO5901150 IFD(2,X)=0THENPRINT" DO YOU HAVE ANOTHER IDEA?":GOTO5901160 C=0:FORJ=1TO29:IFD(1,J)=99THENC=C+11170 NEXT:IFC>A THENPRINT"YOU CANNOT CARRY ANYMORE":GOTO5901190 PRINT "OK...YOU'VE GOT IT":D(1,X)=99:D(3,X)=1:GOTO5901200 IFN$="NOR"ANDP(1,Y)<>0THENPATH=1:GOTO32001201 IFN$="SOU"ANDP(2,Y)<>0THENPATH=1:GOTO32001202 IFN$="EAS"ANDP(3,Y)<>0THENPATH=1:GOTO32001203 IFN$="WES"ANDP(4,Y)<>0THENPATH=1:GOTO32001206 IFN$="NOR"ORN$="SOU"ORN$="EAS"ORN$="WES"THEN32001210 FORX=1TO29:IFN$=M$(1,X)THEN12251220 NEXT:PRINT"THAT NOUN IS NOT IN MY":PRINT" VOCABULARY":GOTO5901225 IFN$="CHE"ANDD(1,17)<>13THENPRINT" YOU DON'T HAVE IT":GOTO5901230 IFD(1,X)<>Y ANDD(1,X)<>99THENPRINT"I DON'T SEE IT":GOTO5901235 IFN$="TRU"ANDY=13ANDD(1,17)=13THENX=151240 IFM$(3,X)="Z"THENPRINT"NOTHING INTERESTING":GOTO5901241 PCLS:SCREEN1,1:Q$=M$(3,X):DRAW"BM100,50S121242 IFX=9THENN$="EAS":GOTO32001244 IFX=14ORX=15THENDRAW"BM150,501245 IFX=4THENDRAW"BM100,401246 IFX=5ORX=6ORX=12THENDRAW"S101247 IFX=8THENDRAW"S81248 IFX>17THENDRAW"S161249 IFX=11THENDRAW"S41250 IFX=25ORX=24ORX=23THENDRAW"BM150,101251 S1$="DNR2DBR2U2NL2":S2$="DNRDR2BU2NL2":S3$="DR2DNL2BU2NL2" 1252 DRAW"XQ$;"1253 IFD(1,15)=13ANDN$="TRU"ANDY=13THENDRAW"BR4E4R18NG4D2NG2D21255 IFASK=1THENDRAW"XS8$;":IFN$="TRO"THENDRAW"BM142,70UNRUR2BR2D2R2U2NL2BR2DNDRNFRUNL2BR4XS3$;BR2XS1$;BR2DNRDBR2BU2NL2BR2XS2$;BM142,75D2BR2BUNL2UNL2BR2XS1$;BR2XS3$;BR2XS3$;BR2XS1$;BR2D2R2UNLBUNL2BR2XS2$;":GOTO5601256 IFT1=1THENDRAW"BM120,65C2R6BM142,60S12FNDEBR2D2R2U2NL2BR2D2R2U2BR4ND2FEND2BR2XS1$;BR2FNDEBM142,70DNDR2UNL2BR2DNDRNFRUNL2BR2D2R2U2NL2BR2D2R2BU2NL2BR2XS2$;BR2XS2$;BR2D2REHL":T1=01257 IFT2=1THENDRAW"BM100,60C2R6BM125,60S12XS1$;BR2RND2RBR2RND2RBR2XS1$;BR2D2R2BU2NL2BR2DNDRNFE":T2=0:FORW=1TO300:NEXT:GOTO25901258 IFN$="SHI"ANDASK=1THENS8$=T$(5):DRAW"XS8$;"1259 GOTO5601260 FORX=1TO29:IFN$=M$(1,X)THEN12801270 NEXT:PRINT"THAT NOUN IS NOT IN MY":PRINT"  VOCABULARY":GOTO5901280 IFD(1,X)<>99THENPRINT"YOU DON'T HAVE IT":GOTO5901290 PRINT"YOU'VE DROPPED IT":D(1,X)=Y:GOTO5901300 IFN$="OGR"ANDD(1,25)=99ANDY=12THEND(1,4)=0:N$="EAS":GOTO32001310 IFN$="OGR"ANDD(1,24)<>99ANDY=12THENT2=1:GOTO12001320 IFN$="TRO"ANDY=16THENM$(2,6)="Z":D(1,6)=0:M$(3,6)="C3":N$="WES":GOTO32001330 PRINT "THAT MAKES NO SENSE":GOTO5901360 IFN$="LAK"ANDY=8THENPRINT" THE LAKE IS TOO WIDE":GOTO5901370 IFN$="ROC"ANDY=21THENPRINT" YOU HIT YOUR HEAD ON THE":PRINT" CEILING...":PRINT" YOU ARE HURT":GOTO25901380 IFN$="PRI"THENPRINT"NOT YET":GOTO5901390 IFN$="STU"ANDY=8THENPRINT" THAT WAS FUN.":GOTO5901400 PRINT" THAT MAKES NO SENSE":GOTO5901410 IFN$="SHI"ANDD(1,5)=Y THENS8$=T$(4):GOTO12001415 IFN$="PRI"ANDD(2,2)=1THENS8$=T$(12):GOTO12001420 IFN$="PRI"ANDY=12ANDD(1,4)=0THENS8$=T$(10):GOTO12001430 IFN$="PRI"ANDY=12ANDD(1,4)<>0THENN$="OGR":S8$=T$(7):GOTO12001440 IFN$="TRO"ANDY=D(1,6)THENS8$=T$(G):IFG=4ORG=5THEN1471ELSE12001450 IFN$="ORA"ANDD(1,1)=5THENS8$=T$(8):GOTO12001460 IFN$="OGR"ANDY=12ANDD(1,4)<>0THENS8$=T$(6):GOTO12001470 PRINT" THAT MAKES NO SENSE":ASK=0:GOTO5901471 S8$=T$(1):GOTO12001480 IFN$="TRU"ANDY=13THEND(1,15)=13:D(1,14)=0:M$(1,14)="Z":M$(1,15)="TRU":D(3,23)=1:GOTO12001490 IFN$="CHE"ANDD(3,23)=1ANDD(1,23)=99THEN29001500 IFN$="BOT"ANDD(3,23)=1ANDD(1,23)=99THENPRINT"IT'S OPEN":D(1,24)=Y:D(3,24)=1:GOTO5901510 IFN$="ROC"ANDY=21THENPRINT"NOTHING HAPPENS":GOTO5901515 IFY<>12THEN15401520 IFN$="CAG"ANDD(1,29)<>99THENPRINT" IT'S LOCKED":GOTO5901525 IFN$="CAG"ANDD(1,4)=12THENN$="OGR":ASK=1:S8$=T$(6):GOTO12001530 IFN$="CAG"ANDD(1,29)=99THEND(2,2)=1:N$="EAS":GOTO32001540 PRINT "I DON'T UNDERSTAND":GOTO5901550 IFN$="ROC"ANDY=21THENROCK=1:P(2,21)=22:N$="SOU":GOTO32001560 PRINT"NOTHING HAPPENS":GOTO5901565 W=241566 IFG=2THENW=21:GOTO15701567 IFG=3THENW=221570 IFN$="TRO"ANDY=16ANDD(1,W)=99THENT=1:T1=1:D(1,W)=0:GOTO12001580 PRINT" NOTHING HAPPENS":GOTO5901590 IFN$="URN"AND(Y=6ORD(1,19)=99)THENASK=1:S8$=T$(9):GOTO12001600 PRINT" THAT MAKES NO SENSE":GOTO5901610 IFN$="FOO"ANDD(1,26)=99THENPRINT" I NEEDED THAT":D(1,26)=0:GOTO5901620 IFN$="FOO"ANDD(1,26)<>99THENPRINT " YOU DON'T HAVE ANY":GOTO5901630 IFN$="MUS"ANDD(1,20)=99THENPRINT" THEY DON'T TASTE VERY GOOD":D(1,20)=8:GOTO5901640 IFN$="MUS"ANDD(1,20)<>99THENPRINT" YOU DON'T HAVE ANY":GOTO5901650 PRINT" DON'T DO THAT":GOTO5901660 P(3,5)=5:L=L+11665 IFL=3THEN1670ELSE16901670 D(1,1)=5:PCLS:SCREEN1,1:Q$=M$(3,1):DRAW"BM80,50;C3S12XQ$;":DRAW"BM194,0;S4XA1$;BM186,112;XA2$;":PAINT(194,11),6,3:PAINT(188,145),8,3:DRAW"BM0,130;R33BR8R13BR33R98BR8R63":PAINT(2,132),6,3:DRAW"BM153,130;NG61BR10F61":PAINT(154,131),8,3:GOTO5601690 IFL<8THEN12001730 Y=8+G:P(3,5)=4:L=0:GOTO12001750 H=Y1760 IFN$="NOR"ANDP(1,Y)<>0THENY=P(1,Y):GOTO18101770 IFN$="SOU"ANDP(2,Y)<>0THENY=P(2,Y):GOTO18101780 IFN$="EAS"ANDP(3,Y)<>0THENY=P(3,Y):GOTO18101790 IFN$="WES"ANDP(4,Y)<>0THENY=P(4,Y):GOTO18101800 PRINT" THERE IS NO PATH":GOTO5901810 E=E+11820 IFH=23ANDY=24THENF=F+1:GOTO18601830 IFH=24ANDY=25THENF=F+1:GOTO18601840 IFH=25ANDY=26THENF=F+1:GOTO18601850 IFH=26ANDY=23THENF=F+11860 IFF>11THEND(1,29)=99:D(3,29)=1:P(4,23)=22:F=0:E=0:N$="KEY":GOTO12001870 IFE>12THENPCLS:SCREEN1,0:DRAW"BM100,80C2S12ND2FEND2BR2ND2BR2XS3$;BR2RND2R":IFE>15THEN2590ELSE5601890 GOTO12001900 CLS:PRINT:PRINT" YOU  HAVE  DONE  WELL.":PRINT:PRINT" YOU HAVE THE PRINCESS AND...":PRINT" WAIT!":PRINT:PRINT" THERE ARE OGRE EYES WATCHING":PRINT" AS YOU HEAD TOWARD THE CASTLE.1905 FOR W=1TO3000:NEXT1910 PRINTSTRING$(32,"*"):PRINT"          COMING SOON!":PRINT:PRINT"    THE SECRET OF THE CRYPT":PRINT:PRINT"     FROM GENESIS SOFTWARE1915 RY$=INKEY$1916 IFRY$=""THEN19151917 CLEAR200:NEW1940 S=1081950 FORX=1TO26:READP(1,X),P(2,X),P(3,X),P(4,X):NEXT1960 DATA0,3,0,01970 DATA0,0,0,31980 DATA1,8,2,41990 DATA0,7,3,52000 DATA0,0,4,52010 DATA0,0,7,02020 DATA4,9,0,62030 DATA3,10,0,02040 DATA7,15,0,02050 DATA8,0,11,02060 DATA0,13,12,102070 DATA0,0,0,112080 DATA11,0,0,142090 DATA0,0,13,152100 DATA9,0,14,162110 DATA0,0,15,02120 DATA0,21,16,182130 DATA0,0,17,192140 DATA0,0,18,202150 DATA0,0,19,02160 DATA17,0,0,02170 DATA21,0,23,02180 DATA0,26,24,02190 DATA0,25,0,232200 DATA24,0,0,262210 DATA23,0,25,02220 FORX=1TO12:READT$(X):NEXT2230 DATA"BM120,65C2R6BM142,60S12U2FEND2BR2D2R2U2NL2BR2ND2F2U2BR2XS2$;BR2FNDE"2235 DATA"BM120,65C2R6BM142,60S12BU2XS1$;BR4ND2F2U2BR2XS2$;BR2RND2R"2240 DATA"BM120,65C2R6BM142,60S12BU2DNRDBR2BU2NL2BR2D2R2U2NL2BR2D2R2U2NL2BR2RND2RBR2D2EFU2BR2XS1$;BR2D2BR2HNLRUNL2BR2XS2$;"2245 DATA "BM98,62C2R10BR2S12RND2RBR2D2BR2HNLRUNL2BR2XS1$;BR2ND2F2U2BR2XS3$;BR2D2R2BU2BR2XS1$;BR2RND2RBR2ND2BR2D2R2U2NL2BR2ND2F2U2BM128,76D2R2U2NL2BR2NR2DNRDBR6UNRUR2BR2ND2BR2DFEUBR2XS2$;BR4D2EFU2BR2ND2BR2D2R2BR2NR2U2"2250 DATA"BM128,90D2R2UNLBUNL2BR2XS2$;BR2RND2RBR4FNDEBR2D2R2U2NL2BR2D2R2U2BR4D2R2BU2NL2BR2XS1$;BR2XS3$;BR2DNDR2NDU"2255 DATA"BM100,61C2R6BM125,61S12NR2U2BR4XS2$;BR2XS1$;BR2DFEUBR2XS2$;"2260 DATA"BM100,60C2R6BM125,60S12BU2XS3$;BR2DNR2DBR2U2BR2XS2$;BR4D2R2BU2NL2BR2XS1$;BR2ND2F2U2BR2ND2F2U2BR2D2R2U2NL2BR2RND2RBM125,70XS3$;BR2DNDR2UNL2BR2XS2$;BR2XS1$;BR2DNDRNFE"2265 DATA"BM100,60C2R6S12BR2BU2D2R2U2BR4D2BR2HNLRUNL2BR2XS2$;BR2DNDR2UNL2BR2D2R2BU2BR2XS1$;BR2D2R2BU2NL2BR2XS2$;BR2XS3$;BR4DNDRNFE"2270 DATA"C2E6R4BR2NR2U2R2BR2ND2BR2D2BR2HNLRUNL2BR2D2R2BU2NL2BR2D2R2BU2BR2XS2$;BL20BD4RND2RBR2D2BR2UNL2UBR2D2BR2HNLRUNL2BR2ND2BR2D2R2BU2NL2BR2XS2$;BL20BD4ND2BR2NR2DNRDBL2BD2RND2RBR2D2BR2HNLRUNL2BR2XS1$;BR2DNDR2UNL2BR2DNDR2UNL2BR2XS2$;BR2D2REHL"2275 DATA"BM100,65C2R8BR2DNDRNFEBR2XS2$;BR2FNDEBR2NDBR2XS3$;BD2BL14BD2ND2BR2ND2F2U2BR4D2R2BU2NL2BR2XS1$;BR2DFEUBR2XS2$;BL22BD4D2R2U2BR2XS3$;BR2XS2$;BR4ND2F2U2BR2FNDEBR2ND2FEND2BR2DNDR2UNL2BR2DNDR2NDUBR2NDBR2XS3$;BL38BD4ND2F2U2BR2XS1$;BR2ND2FEND2BR2XS2$;2276 DATA"D2R2U2B2XS3$;"2278 DATA"BM100,65C2R6BR2RND2RBR2D2R2U2NL2BR4RND2RBR2D2BR2UNL2UBR2XS2$;BL20BD4D2R2BU2NL2BR2XS1$;BR2XS3$;BR2RND2RBR2D2R2BU2BR2XS2$;"2280 FORX=1TO29:READM$(1,X),M$(2,X),D(1,X),D(2,X),D(3,X):NEXT2290 DATA"ORA","AN ORACLE",0,0,12300 DATA"PRI","THE PRINCESS CHARLOTTE",12,0,12310 DATA"FRO","A TREE FROG",4,1,12320 DATA"OGR","AN OGRE",12,0,12330 DATA"SHI","SHINVA THE WOOD NYMPH",9,0,12340 DATA"TRO","AN OLD TROLL",16,0,12350 DATA"CAG","A LOCKED CAGE",12,0,12360 DATA"CAV","A DARK CAVE",16,0,12370 DATA"LAK","A SPARKLING LAKE",8,0,12380 DATA"SIG","A SIGN",11,0,12390 DATA"PIT","A DARK PIT",0,0,02400 DATA"STU","AN OLD STUMP",8,0,12410 DATA"CAS","A CASTLE IN THE DISTANCE",1,0,12420 DATA"TRU","A LARGE TRUNK",13,0,12430 DATA"Z","A LARGE TRUNK",0,0,12440 DATA"ROC","A LARGE ROCK",21,0,12450 DATA"Z","A LARGE TRUNK",0,0,12460 DATA"LAN","A LANTERN",2,1,12470 DATA"URN","AN OLD URN",6,1,12480 DATA"MUS","A BUNCH OF MUSHROOMS",8,1,12490 DATA"NET","A FISHING NET",7,1,12500 DATA"BOO","A PAIR OF HIP BOOTS",10,1,12510 DATA"CHE","A SMALL CHEST",0,1,02520 DATA"COI","GOLD COINS",0,1,02530 DATA"AXE","AN AXE",20,1,12540 DATA"FOO","FOOD",99,1,12550 DATA"ROP", "A COILED ROPE",99,1,12560 DATA"SWO", "A SHARP SWORD",99,1,12570 DATA"KEY", "**THE KEY**",0,1,02580 RETURN2590 FORW=1TO300:NEXT2600 IFG=1ANDT=0THENG=4:GOTO26802610 IFG=1ANDT<>0THENG=2:GOTO26802620 IFG=2THENG=3:GOTO26802630 IFG=3THENG=1:GOTO26802640 IFG=4ANDT=0THENG=5:GOTO26802650 IFG=4ANDT<>0THENG=1:GOTO26802660 IFG=5ANDT=0THENG=1:GOTO26802670 IFG=5ANDT<>0THENG=22680 RESTORE:GOSUB1950:GOSUB39902690 IFG=2ORG=4THENP(4,3)=0:P(2,14)=4:P(1,4)=14:P(3,4)=0:P(2,9)=0:P(1,15)=02700 IFG=3ORG=5THENP(3,2)=10:P(4,10)=2:P(1,10)=0:P(2,8)=0:P(4,14)=0:P(3,15)=02710 CLS:PRINT:PRINT" THAT WAS AN UNWISE MOVE.2720 ERR=ERR+12730 IFERR=1THEN27702740 IFERR=2THENA=1:GOTO27702750 IFERR=3THENA=0:GOTO27702760 IFERR=4THENPRINT:PRINT" I'M SORRY.":PRINT" THE FORCE CAN'T SAVE YOU.":PRINT" YOU ARE TOO WEAK.":CLEAR200:NEW2770 PRINT:PRINT" BUT THE FORCE OF THE ":PRINT" FOREST CAN SAVE YOU.":PRINT" BUT, ALAS, YOU WILL BE WEAKER.":PRINT2780 I=Y:IFY>16THENI=12790 FORJ=1TO29:IFD(1,J)=99THEND(1,J)=I2800 NEXT2810 PRINT" TO BE SAVED ":PRINT" DEPRESS SPACEBAR2820 U$=INKEY$2830 IFU$=""THEN28202840 IFU$=" "THENCLS:Y=8-G:E=0:F=0:L=0:T=0:N$="SOU":GOTO12002900 PCLS:SCREEN1,12905 F5$="D2R2U2NL22910 F6$="DBDR2UNL2BUNL22915 DRAW"BM20,80S24C2DNRDR2BU2NL2BR2FNGNFEBR2DNDR2UNL2BR2D2R2BU2BR2XF5$;BR2XF6$;BR2ND2BR2XF5$;BR2ND2F2U2BR2XF6$;"2920 GOTO25902950 PCLS:SCREEN1,02955 DRAW"BM20,80C2S24D2R2BU2NL2BR2DNDR2NDUNL2BR2ND2F2U2BR2NDBR2RND2RBR4DBDR2UNL2BUNL2BR2DNRDR2BU2NL2BR2DNRDR2BU2NL2"2960 GOTO25903000 A1$="C3LG4LG4LG4LG4LG4;D4LD4LD4LD4;LD4LD4LD4LD4;LD4LD4LD4LD16;RD4RD4RD4;F4RF4RF4RF4RF4R12;E4R2E4R2E4R2E4R2E4R2;U4RU4RU4RU16;LU4LU4LU4LU4;LU4LU4LU4LU4;LU4LU4LU4;H4LH4LH4LH4LH4L"3005 PMODE3,1:PCLS:SCREEN1,13010 DRAW"S4BM46,0;XA1$;BM+74,0;XA1$;BM+74,0;XA1$;"3020 A2$="D34R8U34"3030 DRAW"BM38,112;XA2$;BM+66,0;XA2$;BM+66,0;XA2$;"3040 FORI=0TO148STEP743050 PAINT(46+I,11),6,33060 PAINT(40+I,145),8,3:NEXT3070 A3$="R38BR8R66BR8R66BR8R66"3080 DRAW"BM0,130;XA3$;"3090 PAINT(0,131),6,33100 IFPATH=1THENDRAW"BM153,130;NG61BR10F61":PAINT(154,131),8,3:PATH=03120 IFN$="NOR"ANDY=1THENQ$=M$(3,13):DRAW"BM98,112;C3S4;XQ$;":PAINT(95,123),7,33130 IFN$="EAS"ANDY=11THENQ$=M$(3,10):DRAW"BM98,112;S4;XQ$;":PAINT(97,113),7,33140 IFN$="SOU"ANDY=13ANDD(1,14)=13THENQ$=M$(3,14):DRAW"BM108,140;S4;XQ$;"3150 IFN$="SOU"ANDY=13ANDD(1,14)=0THENQ$=M$(3,15):DRAW"BM108,140;S4;XQ$;":IFD(1,15)=13THENDRAW"BR4E4R18NG4D2NG2D23160 IFY=D(1,3)THENQ$=M$(3,3):DRAW"BM40,160S4XQ$;"3190 GOTO34003200 PMODE3,1:PCLS:SCREEN1,13205 IFY>16THEN35003210 IFN$="WES"ANDY=16THENQ$=M$(3,8):DRAW"C3BM240,10;S10;XQ$;":PAINT(230,50),6,3:PAINT(150,155),8,3:Q$=M$(3,6):DRAW"BM40,50;XQ$;":PAINT(40,80),7,3:PAINT(40,140),8,3:PAINT(250,180),6,3:PAINT(10,180),6,3:GOTO5603220 IFN$="EAS"ANDY=8THENQ$=M$(3,9):SCREEN1,1:DRAW"C4BM255,50S8XQ$;":PAINT(150,55),3,4:Q$=M$(3,12):DRAW"BM210,120C4S12XQ$;":PAINT(175,145),1,4:Q$=M$(3,20):DRAW"BM60,130S4XQ$;BM+60,0XQ$;":PAINT(10,100),2,4:GOTO5603230 IFN$="EAS"ANDY=9THENQ$=M$(3,5):DRAW"BM30,50C3S10XQ$;":PAINT(32,50),8,3:PAINT(60,50),8,3:PAINT(30,110),7,3:PAINT(30,87),7,3:DRAW"BM200,0S4XA1$;BM-74,0XA1$;BM192,112XA2$;BM-82,0XA2$;":PAINT(200,11),6,3:PAINT(194,145),8,3:GOTO3235ELSE32403235 PAINT(126,11),6,3:PAINT(122,145),8,3:DRAW"BM0,0C6F16R16E12F10R10E16":PAINT(5,0),6,6:DRAW"BM0,130C3R16BR46R56BR10R62BR12R60":PAINT(250,131),6,3:PAINT(0,131),6,3:PAINT(25,191),6,3:GOTO5603240 IFY=12ANDN$="EAS"THEN3260ELSE33903260 IFD(2,2)=1THENDRAW"BM180,50"ELSEDRAW"BM50,503270 IFD(1,2)<>99THENQ$=M$(3,2):DRAW"C3S12XQ$;":IFD(2,2)=0THENPAINT(48,48),8,3:PAINT(62,140),3,3:PAINT(26,140),3,33275 Q$=M$(3,7):DRAW"BM0,20C3S12XQ$;"3280 IFD(1,4)=12THENQ$=M$(3,4):DRAW"BM200,40XQ$;":PAINT(204,114),6,3:PAINT(204,36),8,33290 DRAW"BM0,150S4R16BR54R88BR42R56"3300 IFD(1,4)=0ANDD(2,2)=0THENDRAW"L1003301 IFD(2,2)=1THENDRAW"BL186L543302 IFD(1,2)=99THENDRAW"R2403305 PAINT(10,160),6,3:PAINT(250,160),6,3:GOTO5603390 GOTO30003400 IFN$<>"NOR"THEN5603410 DRAW"BM255,1403420 FORJ=18TO293430 IFD(1,J)=Y ANDD(3,J)<>0THENQ$=M$(3,J):DRAW"BM-20,0;S4;XQ$;"3440 NEXT3450 GOTO5603500 A10$="D12F4D2F2D2F2E2U2E2U12E2U2F2D4F2D6E2U4E2U4E2D4F2D12F2D12F2E2U10E2U18E2F2NR30BM+26,+64;U6H4U8H2L4U2G6D14L2UH2UHU4H2U2GD5G3D6"3505 PMODE3,1:PCLS:SCREEN1,03510 DRAW"BM 60,0;S12;C3;XA10$;"3515 PAINT(71,10),3,3:PAINT(190,190),3,33517 IFY=21ANDN$="SOU"THENPATH=13530 IFPATH=1THENDRAW"BM-16,0;H18L4H10H2U10E2E2U4E2R2F6D6F4D4G2NL14F6R2F22":PAINT(130,190),2,3:PAINT(60,90),2,3:PATH=03537 IFROCK=0ANDY=21ANDN$="SOU"THENDRAW"BM35,65;C1G6D4F4R14E4U4H10G2L2G2":PAINT(60,100),4,13540 GOTO34003990 FORX=1TO29:READM$(3,X):NEXT4000 DATA"H2L2G4D2R2NU4D2L2G2D2G2ND2U6H2R2ND2NL4U2LND2LND2LND2LD2RD40R2U28NU11RE4NU2D10F2R4NR2D11FL2EBL2BU9NE2D6FL2EBL4NU10D12E2F2NL4R2E2F2NL4U20H2U10NE2D12RNUD4RU4F2U18H2L2G2ND2E2D4G2D6G2U4H2U4F2ND2H2U4NF2U3R2NER2NHR2ND3U3F2D2L2BL2L2BU3NLBR2R"4010 DATA"U2GHGHGHD2NR6G2D6G2D2F2R2BU4BL4G2D8FD19GDGRE4U4E2U19RD2NR2D9NR6DNR6D8G2D4G4L2NER5NU3RNE2R4NH2R2NE2R4NH2RNURNR4H2U4H2U20NL2U2RD21F2D4F2R3FNL4H3U20EU8H2D2G2L3U2L2NUL2D2NLU7FR2END5U2BLGHBLND2HU2E2BD2LBD2BRRNU2RBU4F2BL2RBRD2GD3BR3NF2U4H2"4020 DATA"U2HUNH2DL2NU2L2U2NR2UNR H2L6G2NLDNL2D2L2NU2L2UNE2DGD2H2LG2D10F2 NU10D6G2R4NU2R2EHU6NU4E2NHD8G2R4NU2R4H2U8ER2FD8G2R4NU2R4 H2U8NEF2NU4D6GFR2NU2R4H2U6NU10E2U10H2LG2 DG3L2BU4NG2BD4L6BU2NH2BD2L4H3UD2F3R12E3UD4GL16HU3"4030 DATA"L6D6H2L4G8D14RNURNURNURU2RHU4E2U2NL2E4D4NF2D8G2D8ND2H2NLH2L4G4F2R2E2F6R4E2NU9D6F2D4G2D2R4NUR2NUR2UH2U12U4G2H2G2U2G2H2G2BR12E2U2NGU2NGU4L6HGL4UNRUNRUNRUER2F2ER6U4NG2U2BD10E6U7H2L4H2G2L2H2BR6U6BD2BLNGBL4FBDDR2NUBDNFL2NGBR4BU2E2U6G2H2G2H2D2G2D4"4040 DATA"L6D8GD2GU12E2R6F2D6G2HBENU6G2L2NH2G2LBLG2D2NR4F8E12ULNGULNGLG10H4BD2BL2D2F2NRF2D6G2D4F8G8D6E2U2E10U2H4U2H2L2D2NG2BR6BD22U12BU6U12H2U2E2NLND6U4BU4U2H2NH2D4G2L2NU2LH4UBR10U12H2E2F2DNHDNHDNHDH2BU3NU22BR10NU22ND64BL16BD7DRUBL3DLUBD2BR2RBD2BRL2"4050 DATA"L2E4FEFEFEF4L2H2L6G2F2D2G2L2G10F8NU2D2F4U4H2E2L2H6E6R2D4F2D2E4F4D2H4G4NU2BR4D2RL2BL3NU2ND2F2R4E2NU2D2G2L4H2D2G2D24G2R4NU3R4H2U20E2F10D12F2R6H2L2U12NH2U4H10U10E2U4F4D2G2R2BU2D4R2NU2E2U2L4BR3EH9LH2BL6D2F3E3U4E2BL2LBLD3BD2RGL2HR3BU2L2U3BLL"4060 DATA"ND55R6ND55R6ND55R6ND55R6ND55R6D25LDRNUD29"4070 DATA"L4D2NR2D2NR4BL4E2U2BL4D2F2BL4U2NL4H2G2D2BL2L4U4R4BD6NR18L4G6D8F6D4G2L4G4D6NR42NL72G2D2G2D2G2D2NG20BD4BR6NG16RR2E2R2E2R2E2R2E2R2E2R2E2R2E2R2E4U4E2U10H2U4E2U2H4U2EH"4080 DATA"L128F4D4F4R4F4R4F4R4F8R12F4R24E4R4E4R4E4R4E4U4R4E4R8E8"4090 DATA"L14U2L4D2NR4L14BF2D4R4UHNL3EUNL4BR2NR4D2NR2D2R4BR2U2E2F2NL4D2BR2R4U2L4U2R4BR2R2ND4R2BL16BD6ND4BR2NR4D2R4D2NL4BU4BF6NR2ND4L2BL2L4D2R4D2L4BL2U2NL4H2G2D2BL2L4U2NR2U2NR4BL6U14D20R14D22R4U22NL4R14U20"4100 DATA"NR155L100BD10F10E5R25E5R20F5R20E5R10F10R10E10R40F5E5R20F10E10R6F5R10E5R20"4110 DATA"H2L12G4BR2E2R12G2BUNL8BDL10BL4D12G4L2G2R4E2R2E2U10BR2BD5D5G4NL4F2E4U8BU4BR2D12G2D2NL4R7UH3U6BU4BR2D10F4NL3U4H2U6BF2U6BF2BD10NL2F2R8H2L5H2U7HU8G4L12"4120 DATA"D18L10U6L6D6NR6L10U18R2D2R2U2R2D6R4U6R2D2R2U2R2D6R4U6R2D2R2U2R2"4130 DATA"H2L4ND10L2D6ND4L12ND4U6NR12L2ND10L4G2D4NR6D14R6U4NFU3NRLU4R4D4L2NDUNURU2L2D2RDRD3NGD4NL2R12U4NFU3NRLU4R4D4L2NDUNURU2L2D2RDRD3NGD4NL2R6U14NL6U4"4140 DATA"ND8H2L6UL2DL12UL2DL6F2R4NU2D3FEU3NU2R12NU2D3FEU3NU2R6NU2D8ND2L26NU8G2NU12NR28ND4G6R29E6NE2D14G6NU14L6NL2G4R2G4L3NGL3E4RGLG2R2NE2R2E2L3E5L11NL2G4R2G4L3NGL3E4RGLG2R2NE2R2E2L3E5L6U14"4150 DATA"Z"4160 DATA"Z"4200 DATA"HL6GD5FNUDFNR4GNF6DGD2FDNE6FNR4GD2R6U2HEUEU2HUHEU2NL6DEU5"4210 DATA"LNL8HL2NL2UL2DL2GLFD3GDBRFNDEBRD2URNFEBRD2R2UNLBUL2BL7D2GDNR12D2NR12DFDFBUUNURNFEBRFNDEBRND2R2DNL2DBDBL8DFR6EUEUEU4HU3HU3E"4220 DATA"L10G4ND2H2L6G2D4F2R2D4G2R8H2U4NL4R2E2NH2R4D6G2R10H2U6NL6R2NE4F2R2D4G2R8H2U4NL4R2E2U2H4L6NF2H2"4230 DATA"RE2ULG2DG7L2G8D2R2ENRENFE2D2NFU2E3D5NFU5EU2GLG7DRE7UED4ND3FDND3F2R2FNL3RFL8NFL2NEL5"4240 DATA"H2L4GNFHL4G2D6R2NR4D13NR2DR2UFR8NUR6UHL4H2U10L6D10F2R4NFL4U12NU6R6U6"4250 DATA"L20G6D28F6R42E6U28H6L22BD32BL20RND4RBR2D3FEU3BR4D3GHBR4FEH2ENFBR8NRGD2FRU2NLBE2RND4RBR2FND3EBR2FND3EBR2RND4RBR2ND4RFGNLFDBU26NR6L22BD4R2D8L4U8R2BDRD2LND3LU2RBU5L24"4260 DATA"L10G4NF4D2F4NR10U2R10ND2E4NH4D2NG4;F4ND2G4D2NE4L8NH4U2NR8H4ND2;BL2ND2G4D2NE4L10NH4U2NR10H4ND2E6R8"4270 DATA"NF2G19HU2G6R2F6D4E8L4H2GD2L2GBE4HNE19HNHC2UNURNFEBRU2BRNR2U2BR2NR2U2BE4D2R2U2NL2NU2R2UNLBUNL2UNURNFRUNL2NR2UNRUR2C3"4280 DATA"L10G2R10NE2D16NE2L10U16R4BD2NR5D4NR3D6BD4R6E2U16"4290 DATA"UL2NHFR3DNRL3NUFR3NUDNL16RDL19NUL2GL2UR2ER3UR2NUR11HNL10UNH2L8NDRUR5NRUR"4300 DATA"L4FD4L4HGDR6D14FEU14R6UHGL4U4E"4310 DATA"H2L8G2ND2F2R2G2NH2G14NR6D2R6NU2E2U2NG2L2NE2L2E4NR4D2R4NU2E2U2NG2L2NE6L2E8NR4D2R4E2U2NG2BL2HL6GFR6E"4320 RETURN4850 S2$="DNRDR2BU2NL2"4860 S3$="NR2DBDR2UNL2BU"4900 FORX=1TO5:IFX=1ORX=3ORX=5THENQ$="C1"ELSEQ$="C25000 DRAW"BM15,150S12XQ$;RND2RBR2D2BR2UNL2UBR2DNRDR2BU2NL2BR4DNRDR2BU2NL2BR2ND2F2U2BR2D2R2BU2NL2BR2D2BR2UNL2UBR2DNDR2NDUNL2BR2ND2F2U2BR2RND2RBR2DNRDR2BU2NL2BR2D2REHNLBR5DNDNRUR2BR2D2R2U2NL2BR2"5005 DRAW"DNDRNFRUNL2BR2DNRDR2BU2NL2BR2DR2DNL2BU2NL2BR2RND2R"5010 FORW=1TO100:NEXT:NEXTX5020 DRAW"BM15,170C1GFBU2BR2D2R2BU2NL2BR2FGBU2BR5D2R2UBUNL2BR2XS2$;BR2ND2F2U2BR2XS2$;BR2XS3$;BR2ND2BR2XS3$;BR4XS3$;BR2D2R2U2NL2BR2DNRNDUR2BR2RND2RBR2D2EFU2BR2DNDR2NDUNL2BR2DNDRNFRUNL2BR2XS2$;"5105 FORW=1TO800:NEXT5300 N5=15500 RETURN